{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nvar _slice = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/slice\"));\n\nvar _from = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/array/from\"));\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _filter = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\"));\n\nvar _concat = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _keys = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/keys\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/createClass\"));\n\nvar _ParseUser = _interopRequireDefault(require(\"./ParseUser\"));\n\nvar _ParseQuery = _interopRequireDefault(require(\"./ParseQuery\"));\n\nvar _ParseObject = _interopRequireDefault(require(\"./ParseObject\"));\n\nvar _ParseACL = _interopRequireDefault(require(\"./ParseACL\"));\n\nvar _createSigningData = _interopRequireDefault(require(\"./createSigningData\"));\n/* global window */\n\n\nvar web3EnablePromise = null;\n\nvar MoralisDot = /*#__PURE__*/function () {\n  function MoralisDot() {\n    (0, _classCallCheck2.default)(this, MoralisDot);\n  }\n\n  (0, _createClass2.default)(MoralisDot, null, [{\n    key: \"web3IsInjected\",\n    value: function value() {\n      return (0, _keys.default)(window.injectedWeb3).length !== 0;\n    }\n  }, {\n    key: \"enable\",\n    value: function () {\n      var _enable = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(opts) {\n        var _window$injectedWeb, _window$injectedWeb$t;\n\n        var type,\n            _args = arguments;\n        return _regenerator.default.wrap(function (_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                type = _args.length > 1 && _args[1] !== undefined ? _args[1] : 'polkadot-js';\n\n                if (!web3EnablePromise) {\n                  _context.next = 3;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", web3EnablePromise);\n\n              case 3:\n                web3EnablePromise = (_window$injectedWeb = window.injectedWeb3) === null || _window$injectedWeb === void 0 ? void 0 : (_window$injectedWeb$t = _window$injectedWeb[type]) === null || _window$injectedWeb$t === void 0 ? void 0 : _window$injectedWeb$t.enable(opts);\n                return _context.abrupt(\"return\", web3EnablePromise);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function () {\n        return _enable.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"authenticate\",\n    value: function () {\n      var _authenticate = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2(opts) {\n        var _opts$name, _context2, _user$get;\n\n        var allAccounts, account, address, dotAddress, accounts, message, data, signature, authData, user;\n        return _regenerator.default.wrap(function (_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return MoralisDot.enable((_opts$name = opts === null || opts === void 0 ? void 0 : opts.name) !== null && _opts$name !== void 0 ? _opts$name : 'Moralis');\n\n              case 2:\n                MoralisDot.web3 = _context3.sent;\n                _context3.next = 5;\n                return MoralisDot.web3.accounts.get();\n\n              case 5:\n                allAccounts = _context3.sent;\n                account = allAccounts[0];\n                address = account === null || account === void 0 ? void 0 : account.address;\n\n                if (address) {\n                  _context3.next = 10;\n                  break;\n                }\n\n                throw new Error('Address not found');\n\n              case 10:\n                dotAddress = address;\n                accounts = [dotAddress];\n                message = MoralisDot.getSigningData();\n                _context3.next = 15;\n                return (0, _createSigningData.default)(message);\n\n              case 15:\n                data = _context3.sent;\n                _context3.next = 18;\n                return MoralisDot.sign(address, data);\n\n              case 18:\n                signature = _context3.sent;\n                authData = {\n                  id: dotAddress,\n                  signature: signature,\n                  data: data\n                };\n                _context3.next = 22;\n                return _ParseUser.default.logInWith('moralisDot', {\n                  authData: authData\n                });\n\n              case 22:\n                user = _context3.sent;\n                _context3.next = 25;\n                return user.setACL(new _ParseACL.default(user));\n\n              case 25:\n                if (user) {\n                  _context3.next = 27;\n                  break;\n                }\n\n                throw new Error('Could not get user');\n\n              case 27:\n                user.set('dotAccounts', uniq((0, _concat.default)(_context2 = []).call(_context2, accounts, (_user$get = user.get('dotAccounts')) !== null && _user$get !== void 0 ? _user$get : [])));\n                user.set('dotAddress', dotAddress);\n                _context3.next = 31;\n                return user.save();\n\n              case 31:\n                return _context3.abrupt(\"return\", user);\n\n              case 32:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function () {\n        return _authenticate.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"link\",\n    value: function () {\n      var _link = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3(account) {\n        var _context4, _user$get2;\n\n        var user, dotAddress, DotAddress, query, dotAddressRecord, data, signature, authData;\n        return _regenerator.default.wrap(function (_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return _ParseUser.default.current();\n\n              case 2:\n                user = _context5.sent;\n                dotAddress = account;\n                DotAddress = _ParseObject.default.extend('_DotAddress');\n                query = new _ParseQuery.default(DotAddress);\n                _context5.next = 8;\n                return query.get(dotAddress).catch(function () {\n                  return null;\n                });\n\n              case 8:\n                dotAddressRecord = _context5.sent;\n\n                if (dotAddressRecord) {\n                  _context5.next = 17;\n                  break;\n                }\n\n                data = MoralisDot.getSigningData();\n                _context5.next = 13;\n                return MoralisDot.sign(dotAddress, data);\n\n              case 13:\n                signature = _context5.sent;\n                authData = {\n                  id: dotAddress,\n                  signature: signature,\n                  data: data\n                };\n                _context5.next = 17;\n                return user.linkWith('moralisDot', {\n                  authData: authData\n                });\n\n              case 17:\n                user.set('dotAccounts', uniq((0, _concat.default)(_context4 = [dotAddress]).call(_context4, (_user$get2 = user.get('dotAccounts')) !== null && _user$get2 !== void 0 ? _user$get2 : [])));\n                user.set('dotAddress', dotAddress);\n                _context5.next = 21;\n                return user.save();\n\n              case 21:\n                return _context5.abrupt(\"return\", user);\n\n              case 22:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function () {\n        return _link.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"unlink\",\n    value: function () {\n      var _unlink = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4(account) {\n        var _user$get3;\n\n        var accountsLower, DotAddress, query, dotAddressRecord, user, accounts, nextAccounts;\n        return _regenerator.default.wrap(function (_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                accountsLower = account;\n                DotAddress = _ParseObject.default.extend('_DotAddress');\n                query = new _ParseQuery.default(DotAddress);\n                _context6.next = 5;\n                return query.get(accountsLower);\n\n              case 5:\n                dotAddressRecord = _context6.sent;\n                _context6.next = 8;\n                return dotAddressRecord.destroy();\n\n              case 8:\n                _context6.next = 10;\n                return _ParseUser.default.current();\n\n              case 10:\n                user = _context6.sent;\n                accounts = (_user$get3 = user.get('dotAccounts')) !== null && _user$get3 !== void 0 ? _user$get3 : [];\n                nextAccounts = (0, _filter.default)(accounts).call(accounts, function (v) {\n                  return v !== accountsLower;\n                });\n                user.set('dotAccounts', nextAccounts);\n                user.set('dotAddress', nextAccounts[0]);\n                _context6.next = 17;\n                return user._unlinkFrom('moralisDot');\n\n              case 17:\n                _context6.next = 19;\n                return user.save();\n\n              case 19:\n                return _context6.abrupt(\"return\", user);\n\n              case 20:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      return function () {\n        return _unlink.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"sign\",\n    value: function () {\n      var _sign = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5(address, data) {\n        var _web3$signer;\n\n        var web3, _yield$web3$signer$si, signature;\n\n        return _regenerator.default.wrap(function (_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                if (web3EnablePromise) {\n                  _context7.next = 2;\n                  break;\n                }\n\n                throw new Error('Must enable MoralisDot');\n\n              case 2:\n                _context7.next = 4;\n                return web3EnablePromise;\n\n              case 4:\n                web3 = _context7.sent;\n                _context7.next = 7;\n                return (_web3$signer = web3.signer) === null || _web3$signer === void 0 ? void 0 : _web3$signer.signRaw({\n                  address: address,\n                  data: stringToHex(data),\n                  type: 'bytes'\n                });\n\n              case 7:\n                _yield$web3$signer$si = _context7.sent;\n                signature = _yield$web3$signer$si.signature;\n                return _context7.abrupt(\"return\", signature);\n\n              case 10:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      return function () {\n        return _sign.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"getSigningData\",\n    value: function value() {\n      return 'Moralis Authentication';\n    }\n  }]);\n  return MoralisDot;\n}();\n\nfunction uniq(arr) {\n  return (0, _filter.default)(arr).call(arr, function (v, i) {\n    return (0, _indexOf.default)(arr).call(arr, v) === i;\n  });\n}\n\nvar _default = MoralisDot;\nexports.default = _default;\n\nfunction stringToHex(value) {\n  return toHexString(stringToU8a(value));\n}\n\nfunction stringToU8a(value) {\n  var u8a = new Uint8Array(value.length);\n\n  for (var i = 0; i < value.length; i++) {\n    u8a[i] = value.charCodeAt(i);\n  }\n\n  return u8a;\n}\n\nfunction toHexString(byteArray) {\n  return \"0x\".concat((0, _from.default)(byteArray, function (byte) {\n    var _context8; // eslint-disable-next-line no-bitwise\n\n\n    return (0, _slice.default)(_context8 = \"0\".concat((byte & 0xff).toString(16))).call(_context8, -2);\n  }).join(''));\n}","map":{"version":3,"sources":["C:/Users/Gustavo/Desktop/proj/meme/node_modules/moralis/lib/browser/MoralisDot.js"],"names":["_interopRequireDefault","require","_Object$defineProperty","exports","value","default","_slice","_from","_indexOf","_filter","_concat","_regenerator","_asyncToGenerator2","_keys","_classCallCheck2","_createClass2","_ParseUser","_ParseQuery","_ParseObject","_ParseACL","_createSigningData","web3EnablePromise","MoralisDot","key","window","injectedWeb3","length","_enable","mark","_callee","opts","_window$injectedWeb","_window$injectedWeb$t","type","_args","arguments","wrap","_context","prev","next","undefined","abrupt","enable","stop","apply","_authenticate","_callee2","_opts$name","_context2","_user$get","allAccounts","account","address","dotAddress","accounts","message","data","signature","authData","user","_context3","name","web3","sent","get","Error","getSigningData","sign","id","logInWith","setACL","set","uniq","call","save","_link","_callee3","_context4","_user$get2","DotAddress","query","dotAddressRecord","_context5","current","extend","catch","linkWith","_unlink","_callee4","_user$get3","accountsLower","nextAccounts","_context6","destroy","v","_unlinkFrom","_sign","_callee5","_web3$signer","_yield$web3$signer$si","_context7","signer","signRaw","stringToHex","arr","i","_default","toHexString","stringToU8a","u8a","Uint8Array","charCodeAt","byteArray","concat","byte","_context8","toString","join"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nvar _slice = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/slice\"));\n\nvar _from = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/array/from\"));\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _filter = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\"));\n\nvar _concat = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime-corejs3/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/asyncToGenerator\"));\n\nvar _keys = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/keys\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/createClass\"));\n\nvar _ParseUser = _interopRequireDefault(require(\"./ParseUser\"));\n\nvar _ParseQuery = _interopRequireDefault(require(\"./ParseQuery\"));\n\nvar _ParseObject = _interopRequireDefault(require(\"./ParseObject\"));\n\nvar _ParseACL = _interopRequireDefault(require(\"./ParseACL\"));\n\nvar _createSigningData = _interopRequireDefault(require(\"./createSigningData\"));\n/* global window */\n\n\nvar web3EnablePromise = null;\n\nvar MoralisDot = /*#__PURE__*/function () {\n  function MoralisDot() {\n    (0, _classCallCheck2.default)(this, MoralisDot);\n  }\n\n  (0, _createClass2.default)(MoralisDot, null, [{\n    key: \"web3IsInjected\",\n    value: function () {\n      return (0, _keys.default)(window.injectedWeb3).length !== 0;\n    }\n  }, {\n    key: \"enable\",\n    value: function () {\n      var _enable = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee(opts) {\n        var _window$injectedWeb, _window$injectedWeb$t;\n\n        var type,\n            _args = arguments;\n        return _regenerator.default.wrap(function (_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                type = _args.length > 1 && _args[1] !== undefined ? _args[1] : 'polkadot-js';\n\n                if (!web3EnablePromise) {\n                  _context.next = 3;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", web3EnablePromise);\n\n              case 3:\n                web3EnablePromise = (_window$injectedWeb = window.injectedWeb3) === null || _window$injectedWeb === void 0 ? void 0 : (_window$injectedWeb$t = _window$injectedWeb[type]) === null || _window$injectedWeb$t === void 0 ? void 0 : _window$injectedWeb$t.enable(opts);\n                return _context.abrupt(\"return\", web3EnablePromise);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function () {\n        return _enable.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"authenticate\",\n    value: function () {\n      var _authenticate = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2(opts) {\n        var _opts$name, _context2, _user$get;\n\n        var allAccounts, account, address, dotAddress, accounts, message, data, signature, authData, user;\n        return _regenerator.default.wrap(function (_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return MoralisDot.enable((_opts$name = opts === null || opts === void 0 ? void 0 : opts.name) !== null && _opts$name !== void 0 ? _opts$name : 'Moralis');\n\n              case 2:\n                MoralisDot.web3 = _context3.sent;\n                _context3.next = 5;\n                return MoralisDot.web3.accounts.get();\n\n              case 5:\n                allAccounts = _context3.sent;\n                account = allAccounts[0];\n                address = account === null || account === void 0 ? void 0 : account.address;\n\n                if (address) {\n                  _context3.next = 10;\n                  break;\n                }\n\n                throw new Error('Address not found');\n\n              case 10:\n                dotAddress = address;\n                accounts = [dotAddress];\n                message = MoralisDot.getSigningData();\n                _context3.next = 15;\n                return (0, _createSigningData.default)(message);\n\n              case 15:\n                data = _context3.sent;\n                _context3.next = 18;\n                return MoralisDot.sign(address, data);\n\n              case 18:\n                signature = _context3.sent;\n                authData = {\n                  id: dotAddress,\n                  signature: signature,\n                  data: data\n                };\n                _context3.next = 22;\n                return _ParseUser.default.logInWith('moralisDot', {\n                  authData: authData\n                });\n\n              case 22:\n                user = _context3.sent;\n                _context3.next = 25;\n                return user.setACL(new _ParseACL.default(user));\n\n              case 25:\n                if (user) {\n                  _context3.next = 27;\n                  break;\n                }\n\n                throw new Error('Could not get user');\n\n              case 27:\n                user.set('dotAccounts', uniq((0, _concat.default)(_context2 = []).call(_context2, accounts, (_user$get = user.get('dotAccounts')) !== null && _user$get !== void 0 ? _user$get : [])));\n                user.set('dotAddress', dotAddress);\n                _context3.next = 31;\n                return user.save();\n\n              case 31:\n                return _context3.abrupt(\"return\", user);\n\n              case 32:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function () {\n        return _authenticate.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"link\",\n    value: function () {\n      var _link = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3(account) {\n        var _context4, _user$get2;\n\n        var user, dotAddress, DotAddress, query, dotAddressRecord, data, signature, authData;\n        return _regenerator.default.wrap(function (_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return _ParseUser.default.current();\n\n              case 2:\n                user = _context5.sent;\n                dotAddress = account;\n                DotAddress = _ParseObject.default.extend('_DotAddress');\n                query = new _ParseQuery.default(DotAddress);\n                _context5.next = 8;\n                return query.get(dotAddress).catch(function () {\n                  return null;\n                });\n\n              case 8:\n                dotAddressRecord = _context5.sent;\n\n                if (dotAddressRecord) {\n                  _context5.next = 17;\n                  break;\n                }\n\n                data = MoralisDot.getSigningData();\n                _context5.next = 13;\n                return MoralisDot.sign(dotAddress, data);\n\n              case 13:\n                signature = _context5.sent;\n                authData = {\n                  id: dotAddress,\n                  signature: signature,\n                  data: data\n                };\n                _context5.next = 17;\n                return user.linkWith('moralisDot', {\n                  authData: authData\n                });\n\n              case 17:\n                user.set('dotAccounts', uniq((0, _concat.default)(_context4 = [dotAddress]).call(_context4, (_user$get2 = user.get('dotAccounts')) !== null && _user$get2 !== void 0 ? _user$get2 : [])));\n                user.set('dotAddress', dotAddress);\n                _context5.next = 21;\n                return user.save();\n\n              case 21:\n                return _context5.abrupt(\"return\", user);\n\n              case 22:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function () {\n        return _link.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"unlink\",\n    value: function () {\n      var _unlink = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4(account) {\n        var _user$get3;\n\n        var accountsLower, DotAddress, query, dotAddressRecord, user, accounts, nextAccounts;\n        return _regenerator.default.wrap(function (_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                accountsLower = account;\n                DotAddress = _ParseObject.default.extend('_DotAddress');\n                query = new _ParseQuery.default(DotAddress);\n                _context6.next = 5;\n                return query.get(accountsLower);\n\n              case 5:\n                dotAddressRecord = _context6.sent;\n                _context6.next = 8;\n                return dotAddressRecord.destroy();\n\n              case 8:\n                _context6.next = 10;\n                return _ParseUser.default.current();\n\n              case 10:\n                user = _context6.sent;\n                accounts = (_user$get3 = user.get('dotAccounts')) !== null && _user$get3 !== void 0 ? _user$get3 : [];\n                nextAccounts = (0, _filter.default)(accounts).call(accounts, function (v) {\n                  return v !== accountsLower;\n                });\n                user.set('dotAccounts', nextAccounts);\n                user.set('dotAddress', nextAccounts[0]);\n                _context6.next = 17;\n                return user._unlinkFrom('moralisDot');\n\n              case 17:\n                _context6.next = 19;\n                return user.save();\n\n              case 19:\n                return _context6.abrupt(\"return\", user);\n\n              case 20:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      return function () {\n        return _unlink.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"sign\",\n    value: function () {\n      var _sign = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5(address, data) {\n        var _web3$signer;\n\n        var web3, _yield$web3$signer$si, signature;\n\n        return _regenerator.default.wrap(function (_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                if (web3EnablePromise) {\n                  _context7.next = 2;\n                  break;\n                }\n\n                throw new Error('Must enable MoralisDot');\n\n              case 2:\n                _context7.next = 4;\n                return web3EnablePromise;\n\n              case 4:\n                web3 = _context7.sent;\n                _context7.next = 7;\n                return (_web3$signer = web3.signer) === null || _web3$signer === void 0 ? void 0 : _web3$signer.signRaw({\n                  address: address,\n                  data: stringToHex(data),\n                  type: 'bytes'\n                });\n\n              case 7:\n                _yield$web3$signer$si = _context7.sent;\n                signature = _yield$web3$signer$si.signature;\n                return _context7.abrupt(\"return\", signature);\n\n              case 10:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      return function () {\n        return _sign.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"getSigningData\",\n    value: function () {\n      return 'Moralis Authentication';\n    }\n  }]);\n  return MoralisDot;\n}();\n\nfunction uniq(arr) {\n  return (0, _filter.default)(arr).call(arr, function (v, i) {\n    return (0, _indexOf.default)(arr).call(arr, v) === i;\n  });\n}\n\nvar _default = MoralisDot;\nexports.default = _default;\n\nfunction stringToHex(value) {\n  return toHexString(stringToU8a(value));\n}\n\nfunction stringToU8a(value) {\n  var u8a = new Uint8Array(value.length);\n\n  for (var i = 0; i < value.length; i++) {\n    u8a[i] = value.charCodeAt(i);\n  }\n\n  return u8a;\n}\n\nfunction toHexString(byteArray) {\n  return \"0x\".concat((0, _from.default)(byteArray, function (byte) {\n    var _context8; // eslint-disable-next-line no-bitwise\n\n\n    return (0, _slice.default)(_context8 = \"0\".concat((byte & 0xff).toString(16))).call(_context8, -2);\n  }).join(''));\n}"]},"metadata":{},"sourceType":"script"}