{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/Gustavo/Desktop/proj/Diskify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/Gustavo/Desktop/proj/Diskify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:/Users/Gustavo/Desktop/proj/Diskify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/Gustavo/Desktop/proj/Diskify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"C:/Users/Gustavo/Desktop/proj/Diskify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"C:/Users/Gustavo/Desktop/proj/Diskify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:/Users/Gustavo/Desktop/proj/Diskify/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\Gustavo\\\\Desktop\\\\proj\\\\Diskify\\\\src\\\\components\\\\Search.js\";\nimport React, { Component } from 'react';\nimport './Search.css';\nimport Web3 from 'web3';\nimport Diskify from '../abis/Diskify.json';\nimport no_results from '../no_results.png';\n\nvar _require = require('ipfs-http-client'),\n    create = _require.create;\n\nvar ipfs = create({\n  host: 'ipfs.infura.io',\n  port: 5001,\n  protocol: 'https'\n});\n\nvar Search = /*#__PURE__*/function (_Component) {\n  _inherits(Search, _Component);\n\n  var _super = _createSuper(Search);\n\n  function Search(props) {\n    var _this2;\n\n    _classCallCheck(this, Search);\n\n    _this2 = _super.call(this, props);\n\n    _this2.logging_noresult = function (_query) {\n      if (_query.length > 0) {//document.getElementById('div-noresults').innerHTML = '';\n      } else {//document.getElementById('div-noresults').innerHTML = \"\"; //add div later;\n      }\n    };\n\n    _this2.finder = function (number, query) {\n      var _this = _assertThisInitialized(_this2);\n\n      _this.contract.methods.getAlbum(number).call({\n        from: _this.eth_account\n      }).then(function (res) {\n        var aid = res['album_info_pointer_ipfs_hash'];\n        console.log('https://ipfs.infura.io/ipfs/' + aid);\n        fetch('https://ipfs.infura.io/ipfs/' + aid).then(function (res) {\n          return res.text();\n        }).then(function (res) {\n          var content = res.JSON();\n          var data_ = content['artist_name'] + \" \" + content['release_date'] + \" \" + content['album_name'] + \" \" + content['artist_name'] + \" \";\n          var tracks = content['track_names'];\n\n          for (var _i = 0; _i < tracks.length; _i++) {\n            data_ += tracks[_i] + \" \";\n          }\n\n          if (data_.search(query)) {\n            return number;\n          }\n\n          return -1;\n        }).catch(function (_) {\n          return console.log(\"error\");\n        });\n      }).catch(function () {\n        return -1;\n      });\n    };\n\n    _this2.resultConstructor = function (number) {\n      var _this = _assertThisInitialized(_this2); //_this.contract.methods.getAlbum(number).call({from: _this.eth_account})\n\n    };\n\n    _this2.searching = function (event) {\n      event.preventDefault();\n      var _query = document.getElementById('input-search').value;\n\n      _this2.logging_noresult(_query);\n\n      var _this = _assertThisInitialized(_this2);\n\n      var limit = 0;\n\n      _this.contract.methods.album_id_counter().call({\n        from: _this.eth_account\n      }).then(function (r) {\n        limit = parseInt(r);\n      }).catch(function (_) {\n        return console.log(\"error\");\n      });\n\n      var album_ids = [];\n\n      for (var i = 0; i < limit + 1; i++) {\n        if (_this.finder(i, _query) > 0) {\n          album_ids.push(i);\n        }\n      } //this.resultConstructor();\n      // document.getElementById('div-appendresults').innerHTML += \"<p>oiiasa </p>\";\n\n    };\n\n    _this2.state = {};\n    _this2.eth_account = '';\n    _this2.contract = '';\n    return _this2;\n  }\n\n  _createClass(Search, [{\n    key: \"componentWillMount\",\n    value: function () {\n      var _componentWillMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.loadWeb3();\n\n              case 2:\n                _context.next = 4;\n                return this.loadBlockchainData();\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentWillMount() {\n        return _componentWillMount.apply(this, arguments);\n      }\n\n      return componentWillMount;\n    }()\n  }, {\n    key: \"loadBlockchainData\",\n    value: function () {\n      var _loadBlockchainData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var web3, accounts, networdId, networkData, abi;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                web3 = window.web3;\n                _context2.next = 3;\n                return web3.eth.getAccounts();\n\n              case 3:\n                accounts = _context2.sent;\n                this.eth_account = accounts[0];\n                console.log(accounts);\n                _context2.next = 8;\n                return web3.eth.net.getId();\n\n              case 8:\n                networdId = _context2.sent;\n                networkData = Diskify.networks[networdId];\n                console.log(networkData, networdId);\n\n                if (!networkData) {\n                  _context2.next = 16;\n                  break;\n                }\n\n                abi = Diskify.abi;\n                this.contract = new web3.eth.Contract(abi, networkData.address);\n                _context2.next = 18;\n                break;\n\n              case 16:\n                window.alert(\"Contract not deployed.\");\n                return _context2.abrupt(\"return\");\n\n              case 18:\n                console.log(this.contract);\n\n              case 19:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function loadBlockchainData() {\n        return _loadBlockchainData.apply(this, arguments);\n      }\n\n      return loadBlockchainData;\n    }()\n  }, {\n    key: \"loadWeb3\",\n    value: function () {\n      var _loadWeb = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!window.ethereum) {\n                  _context3.next = 4;\n                  break;\n                }\n\n                window.web3 = new Web3(window.ethereum);\n                _context3.next = 4;\n                return window.ethereum.enable();\n\n              case 4:\n                if (window.web3) {\n                  window.web3 = new Web3(window.web3.currentProvider);\n                } else {\n                  console.log(\"User did not connect its metamask wallet.\");\n                }\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function loadWeb3() {\n        return _loadWeb.apply(this, arguments);\n      }\n\n      return loadWeb3;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 4\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"container-fluid mt-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"main\", {\n        role: \"main\",\n        className: \"col-lg-12 d-flex grid grid-cols-1 text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        id: \"div-search\",\n        className: \"mr-auto ml-auto -mt-8 w-5/6\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        id: \"input-search\",\n        onChange: this.searching,\n        className: \"font-mono w-5/6 bg-gray-100 border-gray-300 h-auto rounded-lg text-3xl p-4 mb-2 hover:bg-gray-100 border-4 border-transparent hover:border-black\",\n        placeholder: \" Search... \",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        id: \"div-appendresults\",\n        className: \"mt-4 container-fluid content-center self-center text-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"grid grid-rows-1 grid-cols-2 w-full bg-gray-100 border-gray-300  h-auto rounded-lg text-3xl p-4 mb-2 hover:bg-gray-100 border-4 border-transparent hover:border-black\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 18\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"w-96 h-96 min-w-80 min-h-80 h-auto \",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: no_results,\n        id: \"img-1\",\n        className: \"h-auto w-auto\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 19\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"grid grid-rows-2 grid-cols-1 text-3xl font-mono\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        className: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 20\n        }\n      }, \" Water \"), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"text-gray-900\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 20\n        }\n      }, \" Genres \"), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 12\n        }\n      }, \" Artist \")))))))));\n    }\n  }]);\n\n  return Search;\n}(Component);\n\nexport default Search;\n/*\r\n\r\n\r\n                <div id='div-noresults' className=' self-center ml-auto mr-auto w-1/2 h-1/2 min-h-96 min-w-96 max-w-96 max-h-96' > \r\n                \t\r\n                \t<br /><br /><br />\r\n\r\n\t                <img src={no_results} id='img-noresults' className=\" Album_cover_display\" alt=\"no results\" />\r\n  \r\n                </div>\r\n\r\n\r\n\r\n\r\n*/","map":{"version":3,"sources":["C:/Users/Gustavo/Desktop/proj/Diskify/src/components/Search.js"],"names":["React","Component","Web3","Diskify","no_results","require","create","ipfs","host","port","protocol","Search","props","logging_noresult","_query","length","finder","number","query","_this","contract","methods","getAlbum","call","from","eth_account","then","res","aid","console","log","fetch","text","content","JSON","data_","tracks","_i","search","catch","_","resultConstructor","searching","event","preventDefault","document","getElementById","value","limit","album_id_counter","r","parseInt","album_ids","i","push","state","loadWeb3","loadBlockchainData","web3","window","eth","getAccounts","accounts","net","getId","networdId","networkData","networks","abi","Contract","address","alert","ethereum","enable","currentProvider"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport './Search.css';\r\n\r\nimport Web3 from 'web3';\r\nimport Diskify from '../abis/Diskify.json';\r\n\r\nimport no_results from '../no_results.png';\r\n\r\nconst {create} = require('ipfs-http-client');\r\n\r\nconst ipfs = create({host: 'ipfs.infura.io', port:5001, protocol:'https'});\r\n\r\n\r\nclass Search extends Component {\r\n\r\n\tasync componentWillMount() {\r\n\r\n    await this.loadWeb3();\r\n\r\n    await this.loadBlockchainData();\r\n\r\n  }\r\n\r\n  async loadBlockchainData() {\r\n\r\n    const web3 = window.web3;\r\n\r\n    const accounts = await web3.eth.getAccounts();\r\n\r\n    this.eth_account = accounts[0];\r\n\r\n    console.log(accounts);\r\n\r\n    const networdId = await web3.eth.net.getId();\r\n    const networkData = Diskify.networks[networdId];\r\n\r\n    console.log(networkData, networdId)\r\n\r\n    if (networkData) {\r\n\r\n      const abi = Diskify.abi;\r\n      this.contract = new web3.eth.Contract(abi, networkData.address);\r\n\r\n\r\n    } else { window.alert(\"Contract not deployed.\"); return; }\r\n    \r\n    console.log(this.contract);\r\n\r\n  }\r\n\r\n\r\n\r\n  constructor (props) {\r\n\r\n  \tsuper(props);\r\n\r\n  \tthis.state = {};\r\n\r\n  \tthis.eth_account = '';\r\n  \tthis.contract = '';\r\n\r\n  }\r\n\r\n\r\n  async loadWeb3() {\r\n\r\n\t  if (window.ethereum) {\r\n\r\n\t    window.web3 = new Web3(window.ethereum);\r\n\t    await window.ethereum.enable();\r\n\r\n\t  } if (window.web3) {\r\n\r\n\t    window.web3 = new Web3(window.web3.currentProvider);\r\n\r\n\t  } else {\r\n\r\n\t  \tconsole.log(\"User did not connect its metamask wallet.\");\r\n\r\n\t  }\r\n\r\n\t}\r\n\r\n\r\n\tlogging_noresult = (_query) => {\r\n\r\n\t\tif (_query.length > 0){\r\n\r\n\t\t\t//document.getElementById('div-noresults').innerHTML = '';\r\n\r\n\t\t} else {\r\n\r\n\t\t\t//document.getElementById('div-noresults').innerHTML = \"\"; //add div later;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\tfinder = (number, query) => {\r\n\r\n\t\tconst _this = this;\r\n\r\n    _this.contract.methods.getAlbum(number).call({from: _this.eth_account}).then((res) => {\r\n\r\n    \t\tvar aid = res['album_info_pointer_ipfs_hash'];\r\n\r\n    \t\tconsole.log('https://ipfs.infura.io/ipfs/'+aid);\r\n\r\n\r\n    \t\tfetch('https://ipfs.infura.io/ipfs/'+aid)\r\n    \t\t.then((res)=>res.text())\r\n    \t\t.then((res)=>{\r\n\r\n\r\n    \t\t\tconst content = res.JSON();\r\n\r\n    \t\t\tvar data_ = content['artist_name']+ \" \"+content['release_date']+ \" \"+\r\n    \t\t\t          content['album_name']+ \" \"+content['artist_name']+\" \";\r\n\r\n    \t\t\tconst tracks = content['track_names'];\r\n    \t\t\t\r\n    \t\t\tfor (var _i = 0; _i < tracks.length; _i++){\r\n\r\n    \t\t\t\tdata_ += tracks[_i]+\" \";\r\n\r\n    \t\t\t}\r\n\r\n    \t\t\tif (data_.search(query)) {\r\n\r\n    \t\t\t\t\treturn number;\r\n\r\n    \t\t\t}\r\n\r\n    \t\t\treturn -1;\r\n\r\n    \t\t}).catch( _ => console.log(\"error\"));\r\n\r\n\r\n    }).catch(() => {\r\n\r\n    \treturn -1;\r\n\r\n    } );\r\n\r\n\t}\r\n\r\n\r\n\tresultConstructor = (number) => {\r\n\r\n\t\tconst _this = this;\r\n\r\n    //_this.contract.methods.getAlbum(number).call({from: _this.eth_account})\r\n    \r\n\r\n\t}\r\n\r\n\r\n\r\n\tsearching = (event) => {\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tconst _query = document.getElementById('input-search').value;\r\n\r\n\t\tthis.logging_noresult(_query);\r\n\r\n\t\tconst _this = this;\r\n\r\n\r\n\t\tvar limit = 0;\r\n\t\t_this.contract.methods.album_id_counter().call({from: _this.eth_account})\r\n\t\t.then( (r) => { limit = parseInt(r); })\r\n\t\t.catch( _ => console.log(\"error\") );\r\n\r\n\t\tvar album_ids = [];\r\n\r\n\t\tfor( var i = 0; i < limit+1; i++ ){\r\n\r\n\t\t\tif (_this.finder(i, _query) > 0) {\r\n\r\n\t\t\t\talbum_ids.push(i);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t//this.resultConstructor();\r\n\r\n\t\t// document.getElementById('div-appendresults').innerHTML += \"<p>oiiasa </p>\";\r\n\r\n\t}\r\n\r\n\r\n\trender(){\r\n\r\n\t\treturn (\r\n\r\n\t\t\t<div>\r\n        <div className=\"container-fluid mt-5\">\r\n          <div className=\"row\">\r\n            <main role=\"main\" className=\"col-lg-12 d-flex grid grid-cols-1 text-center\">\r\n              <div id='div-search' className=\"mr-auto ml-auto -mt-8 w-5/6\">\r\n              \r\n\r\n                <input type='text' id='input-search' onChange={this.searching} className='font-mono w-5/6 bg-gray-100 border-gray-300 h-auto rounded-lg text-3xl p-4 mb-2 hover:bg-gray-100 border-4 border-transparent hover:border-black' placeholder=\" Search... \" />\r\n                <br/>\r\n\r\n                \r\n                <div id='div-appendresults' className=\"mt-4 container-fluid content-center self-center text-center\">\r\n\r\n                \t<div className=\"grid grid-rows-1 grid-cols-2 w-full bg-gray-100 border-gray-300  h-auto rounded-lg text-3xl p-4 mb-2 hover:bg-gray-100 border-4 border-transparent hover:border-black\">\r\n\r\n                \t\t<div className='w-96 h-96 min-w-80 min-h-80 h-auto '>\r\n\r\n                \t\t<img src={no_results} id='img-1' className='h-auto w-auto' />\r\n\r\n                \t\t</div>\r\n                \t\t\r\n                \t\t<div className='grid grid-rows-2 grid-cols-1 text-3xl font-mono'>\r\n\r\n                \t\t\t<p className=''> Water </p>\r\n                \t\t\r\n                \t\t\t<p className='text-gray-900'> Genres </p>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<p className=''> Artist </p>\r\n\t\t\t\t\t\t\t\t\t\t\t                \t\t\t\r\n                \t\t</div>\r\n\r\n                \t</div>\r\n\r\n                </div>\r\n                \r\n              </div>\r\n            </main>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n\r\n\r\n\t\t);\r\n\r\n\t}\r\n\r\n}\r\n\r\n\r\nexport default Search;\r\n/*\r\n\r\n\r\n                <div id='div-noresults' className=' self-center ml-auto mr-auto w-1/2 h-1/2 min-h-96 min-w-96 max-w-96 max-h-96' > \r\n                \t\r\n                \t<br /><br /><br />\r\n\r\n\t                <img src={no_results} id='img-noresults' className=\" Album_cover_display\" alt=\"no results\" />\r\n  \r\n                </div>\r\n\r\n\r\n\r\n\r\n*/"]},"metadata":{},"sourceType":"module"}